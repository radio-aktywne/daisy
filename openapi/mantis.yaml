openapi: "3.1.0"
info:
  title: mantis
  version: "0.18.0"
paths:
  /ping:
    get:
      tags:
        - Ping
      summary: Ping
      description: Ping.
      operationId: PingPing
      responses:
        "204":
          description: Successful ping.
      deprecated: false
    head:
      tags:
        - Ping
      summary: Ping headers
      description: Ping headers.
      operationId: PingHeadping
      responses:
        "204":
          description: Successful ping.
      deprecated: false
  /sse:
    get:
      tags:
        - SSE
      summary: Get SSE stream
      description: Get a stream of Server-Sent Events.
      operationId: SseSubscribe
      responses:
        "200":
          description: Stream of Server-Sent Events.
          content:
            text/event-stream:
              schema:
                type: string
      deprecated: false
  /tasks/{id}:
    get:
      tags:
        - Tasks
      summary: Get task
      description: Get a task.
      operationId: TasksIdGet
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
    delete:
      tags:
        - Tasks
      summary: Cancel task
      description: Cancel a task.
      operationId: TasksIdCancel
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/CancelRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CancelResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks/clean:
    post:
      tags:
        - Tasks
      summary: Clean tasks
      description: Clean tasks.
      operationId: TasksCleanClean
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CleanRequestData"
        required: true
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CleanResponseResults"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - properties:
                      status_code:
                        type: integer
                      detail:
                        type: string
                      extra:
                        additionalProperties: {}
                        type:
                          - "null"
                          - object
                          - array
                    type: object
                    required:
                      - detail
                      - status_code
                    description: Bad Request Exception
                    examples:
                      - status_code: 400
                        detail: Bad Request
                        extra: {}
                  - properties:
                      status_code:
                        type: integer
                      detail:
                        type: string
                      extra:
                        additionalProperties: {}
                        type:
                          - "null"
                          - object
                          - array
                    type: object
                    required:
                      - detail
                      - status_code
                    description: Validation Exception
                    examples:
                      - status_code: 400
                        detail: Bad Request
                        extra: {}
      deprecated: false
  /tasks/cancelled/{id}:
    get:
      tags:
        - Tasks
      summary: Get cancelled task
      description: Get a cancelled task.
      operationId: TasksCancelledIdGetCancelled
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetCancelledRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetCancelledResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks/completed/{id}:
    get:
      tags:
        - Tasks
      summary: Get completed task
      description: Get a completed task.
      operationId: TasksCompletedIdGetCompleted
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetCompletedRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetCompletedResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks/failed/{id}:
    get:
      tags:
        - Tasks
      summary: Get failed task
      description: Get a failed task.
      operationId: TasksFailedIdGetFailed
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetFailedRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetFailedResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks/pending/{id}:
    get:
      tags:
        - Tasks
      summary: Get pending task
      description: Get a pending task.
      operationId: TasksPendingIdGetPending
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetPendingRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetPendingResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks/running/{id}:
    get:
      tags:
        - Tasks
      summary: Get running task
      description: Get a running task.
      operationId: TasksRunningIdGetRunning
      parameters:
        - name: id
          in: path
          schema:
            $ref: "#/components/schemas/GetRunningRequestId"
          required: true
          deprecated: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetRunningResponseTask"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
        "404":
          description: Not Found
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Not Found Exception
                examples:
                  - status_code: 404
                    detail: Not Found
                    extra: {}
      deprecated: false
  /tasks:
    get:
      tags:
        - Tasks
      summary: Get index
      description: List tasks.
      operationId: TasksList
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListResponseTasks"
      deprecated: false
    post:
      tags:
        - Tasks
      summary: Schedule task
      description: Schedule a task.
      operationId: TasksSchedule
      requestBody:
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ScheduleRequestData"
        required: true
      responses:
        "201":
          description: Document created, URL follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ScheduleResponseTask"
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                oneOf:
                  - properties:
                      status_code:
                        type: integer
                      detail:
                        type: string
                      extra:
                        additionalProperties: {}
                        type:
                          - "null"
                          - object
                          - array
                    type: object
                    required:
                      - detail
                      - status_code
                    description: Bad Request Exception
                    examples:
                      - status_code: 400
                        detail: Bad Request
                        extra: {}
                  - properties:
                      status_code:
                        type: integer
                      detail:
                        type: string
                      extra:
                        additionalProperties: {}
                        type:
                          - "null"
                          - object
                          - array
                    type: object
                    required:
                      - detail
                      - status_code
                    description: Validation Exception
                    examples:
                      - status_code: 400
                        detail: Bad Request
                        extra: {}
      deprecated: false
  /test:
    get:
      tags:
        - Test
      summary: Test
      description: Test.
      operationId: TestTest
      parameters:
        - name: parameters
          in: query
          schema:
            oneOf:
              - anyOf:
                  - $ref: "#/components/schemas/TestRequestParameters"
                  - type: string
                    contentMediaType: application/json
                    contentSchema:
                      $ref: "#/components/schemas/TestRequestParameters"
                title: TestRequestParameters
              - type: "null"
            description: Parameters for testing.
          description: Parameters for testing.
          required: false
          deprecated: false
          allowEmptyValue: false
          allowReserved: false
      responses:
        "200":
          description: Request fulfilled, document follows
          headers: {}
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TestResponseResult"
        "400":
          description: Bad request syntax or unsupported method
          content:
            application/json:
              schema:
                properties:
                  status_code:
                    type: integer
                  detail:
                    type: string
                  extra:
                    additionalProperties: {}
                    type:
                      - "null"
                      - object
                      - array
                type: object
                required:
                  - detail
                  - status_code
                description: Validation Exception
                examples:
                  - status_code: 400
                    detail: Bad Request
                    extra: {}
      deprecated: false
components:
  schemas:
    CancelRequestId:
      type: string
      format: uuid
    CancelResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
        started:
          anyOf:
            - $ref: "#/components/schemas/NaiveDatetime"
            - type: "null"
          description: Datetime in UTC when the task was started.
        cancelled:
          $ref: "#/components/schemas/NaiveDatetime"
      type: object
      required:
        - task
        - scheduled
        - started
        - cancelled
      title: CancelledTask
      description: Data of a cancelled task.
    CleanRequestData:
      properties:
        strategy:
          $ref: "#/components/schemas/Specification"
      type: object
      required:
        - strategy
      title: CleanRequestModel
      description: Request to clean tasks.
    CleanResponseResults:
      properties:
        removed:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Removed
          description: Identifiers of removed tasks.
      type: object
      required:
        - removed
      title: CleaningResult
      description: Result of cleaning.
    GetCancelledRequestId:
      type: string
      format: uuid
    GetCancelledResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
        started:
          anyOf:
            - $ref: "#/components/schemas/NaiveDatetime"
            - type: "null"
          description: Datetime in UTC when the task was started.
        cancelled:
          $ref: "#/components/schemas/NaiveDatetime"
      type: object
      required:
        - task
        - scheduled
        - started
        - cancelled
      title: CancelledTask
      description: Data of a cancelled task.
    GetCompletedRequestId:
      type: string
      format: uuid
    GetCompletedResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
        started:
          $ref: "#/components/schemas/NaiveDatetime"
        completed:
          $ref: "#/components/schemas/NaiveDatetime"
        result:
          anyOf:
            - additionalProperties: true
              type: object
            - items: {}
              type: array
            - type: string
            - type: integer
            - type: number
            - type: boolean
            - type: "null"
          title: Result
          description: Result of the task.
      type: object
      required:
        - task
        - scheduled
        - started
        - completed
        - result
      title: CompletedTask
      description: Data of a completed task.
    GetFailedRequestId:
      type: string
      format: uuid
    GetFailedResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
        started:
          $ref: "#/components/schemas/NaiveDatetime"
        failed:
          $ref: "#/components/schemas/NaiveDatetime"
        error:
          type: string
          title: Error
          description: Error message.
      type: object
      required:
        - task
        - scheduled
        - started
        - failed
        - error
      title: FailedTask
      description: Data of a failed task.
    GetPendingRequestId:
      type: string
      format: uuid
    GetPendingResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
      type: object
      required:
        - task
        - scheduled
      title: PendingTask
      description: Data of a pending task.
    GetRequestId:
      type: string
      format: uuid
    GetResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        status:
          $ref: "#/components/schemas/Status"
      type: object
      required:
        - task
        - status
      title: GenericTask
      description: Data of a task of any status.
    GetRunningRequestId:
      type: string
      format: uuid
    GetRunningResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
        started:
          $ref: "#/components/schemas/NaiveDatetime"
      type: object
      required:
        - task
        - scheduled
        - started
      title: RunningTask
      description: Data of a running task.
    ListResponseTasks:
      properties:
        pending:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Pending
          description: Identifiers of pending tasks.
        running:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Running
          description: Identifiers of running tasks.
        cancelled:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Cancelled
          description: Identifiers of cancelled tasks.
        failed:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Failed
          description: Identifiers of failed tasks.
        completed:
          items:
            type: string
            format: uuid
          type: array
          uniqueItems: true
          title: Completed
          description: Identifiers of completed tasks.
      type: object
      required:
        - pending
        - running
        - cancelled
        - failed
        - completed
      title: TaskIndex
      description: Index of tasks by status.
    NaiveDatetime:
      type: string
      format: date-time
      examples:
        - 2000-01-01T00:00:00
    Parameters:
      properties:
        message:
          anyOf:
            - type: string
            - type: "null"
          title: Message
          description: Optional message to include in the test.
          default: null
      type: object
      title: Parameters
      description: Parameters for testing.
    ScheduleRequestData:
      properties:
        operation:
          $ref: "#/components/schemas/Specification"
        condition:
          $ref: "#/components/schemas/Specification"
        dependencies:
          additionalProperties:
            type: string
            format: uuid
          type: object
          title: Dependencies
          description: Dependencies of the task.
      type: object
      required:
        - operation
        - condition
        - dependencies
      title: ScheduleRequestModel
      description: Request to schedule a task.
    ScheduleResponseTask:
      properties:
        task:
          $ref: "#/components/schemas/Task"
        scheduled:
          $ref: "#/components/schemas/NaiveDatetime"
      type: object
      required:
        - task
        - scheduled
      title: PendingTask
      description: Data of a pending task.
    Specification:
      properties:
        type:
          type: string
          title: Type
        parameters:
          additionalProperties:
            anyOf:
              - additionalProperties: true
                type: object
              - items: {}
                type: array
              - type: string
              - type: integer
              - type: number
              - type: boolean
              - type: "null"
          type: object
          title: Parameters
      type: object
      required:
        - type
        - parameters
      title: Specification
    Status:
      type: string
      enum:
        - pending
        - running
        - cancelled
        - failed
        - completed
      title: Status
      description: Status of a task.
    Task:
      properties:
        id:
          type: string
          format: uuid
          title: Id
        operation:
          $ref: "#/components/schemas/Specification"
        condition:
          $ref: "#/components/schemas/Specification"
        dependencies:
          additionalProperties:
            type: string
            format: uuid
          type: object
          title: Dependencies
      type: object
      required:
        - id
        - operation
        - condition
        - dependencies
      title: Task
    TestRequestParameters:
      anyOf:
        - $ref: "#/components/schemas/Parameters"
        - type: "null"
    TestResponseResult:
      properties:
        success:
          type: boolean
          title: Success
          description: Indicates if the test was successful.
        message:
          type: string
          title: Message
          description: Message returned from the test.
      type: object
      required:
        - success
        - message
      title: Result
      description: Result of the test.
